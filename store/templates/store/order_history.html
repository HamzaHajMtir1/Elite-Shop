{% extends 'base.html' %}

{% block title %}Order History - Elite Shop{% endblock %}

{% block content %}

<!-- Page Header -->
<section class="bg-gradient-to-r from-purple-600 to-indigo-600 text-white py-12">
    <div class="container mx-auto px-4">
        <div class="text-center">
            <h1 class="text-4xl font-bold mb-2">Order History</h1>
            <p class="text-purple-100">Track and manage your orders</p>
        </div>
    </div>
</section>

<!-- Orders List -->
<section class="py-12 bg-gray-50">
    <div class="container mx-auto px-4">
        <div class="max-w-5xl mx-auto">
            
            {% if orders %}
            <div class="space-y-6">
                {% for order in orders %}
                <div class="bg-white rounded-2xl shadow-md overflow-hidden hover-shadow smooth-transition">
                    <!-- Order Header -->
                    <div class="bg-gray-50 px-6 py-4 border-b flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4">
                        <div>
                            <h3 class="text-lg font-bold text-gray-800 mb-1">Order #{{ order.order_number }}</h3>
                            <p class="text-sm text-gray-600">
                                <i class="far fa-calendar mr-2"></i>{{ order.created_at|date:"F d, Y" }}
                            </p>
                        </div>
                        
                        <div class="flex items-center gap-4">
                            <span class="px-4 py-2 rounded-full text-sm font-semibold
                                {% if order.status == 'delivered' %}bg-green-100 text-green-800
                                {% elif order.status == 'shipped' %}bg-blue-100 text-blue-800
                                {% elif order.status == 'processing' %}bg-yellow-100 text-yellow-800
                                {% elif order.status == 'cancelled' %}bg-red-100 text-red-800
                                {% else %}bg-gray-100 text-gray-800{% endif %}">
                                {{ order.get_status_display }}
                            </span>
                        </div>
                    </div>
                    
                    <!-- Order Items -->
                    <div class="p-6">
                        <div class="space-y-4 mb-6">
                            {% for item in order.items.all %}
                            <div class="flex items-center gap-4">
                                <div class="w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0">
                                    {% if item.product and item.product.image %}
                                    <img src="{{ item.product.image.url }}" alt="{{ item.product_name }}" class="w-full h-full object-cover">
                                    {% else %}
                                    <div class="flex items-center justify-center h-full">
                                        <i class="fas fa-image text-gray-300"></i>
                                    </div>
                                    {% endif %}
                                </div>
                                
                                <div class="flex-1">
                                    <h4 class="font-semibold text-gray-800">{{ item.product_name }}</h4>
                                    <p class="text-sm text-gray-600">Qty: {{ item.quantity }} Ã— {{ item.product_price }} TND</p>
                                </div>
                                
                                <div class="text-right">
                                    <p class="font-bold text-gray-800">{{ item.get_total }} TND</p>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        
                        <!-- Order Footer -->
                        <div class="flex flex-col sm:flex-row justify-between items-center gap-4 pt-4 border-t">
                            <div>
                                <p class="text-sm text-gray-600 mb-1">Payment Method</p>
                                <p class="font-semibold text-gray-800">
                                    {% if order.payment_method == 'stripe' %}
                                    <i class="fas fa-credit-card text-purple-600 mr-2"></i>Credit Card
                                    {% elif order.payment_method == 'cod' %}
                                    <i class="fas fa-money-bill-wave text-green-600 mr-2"></i>Cash on Delivery
                                    {% endif %}
                                </p>
                            </div>
                            
                            <div class="text-center sm:text-right">
                                <p class="text-sm text-gray-600 mb-1">Total Amount</p>
                                <p class="text-2xl font-bold text-purple-600">{{ order.get_total }} TND</p>
                            </div>
                            
                            <a href="{% url 'order_detail' order.id %}" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition font-semibold whitespace-nowrap">
                                View Details
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            
            {% else %}
            
            <!-- No Orders -->
            <div class="bg-white rounded-2xl shadow-md p-12 text-center">
                <div class="w-32 h-32 mx-auto mb-6 bg-purple-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-box-open text-purple-600 text-6xl"></i>
                </div>
                <h2 class="text-3xl font-bold text-gray-800 mb-4">No Orders Yet</h2>
                <p class="text-gray-600 mb-8">You haven't placed any orders yet. Start shopping now!</p>
                <a href="{% url 'products' %}" class="inline-block bg-purple-600 text-white px-8 py-4 rounded-full hover:bg-purple-700 transition font-semibold">
                    <i class="fas fa-shopping-bag mr-2"></i>
                    Start Shopping
                </a>
            </div>
            
            {% endif %}
        </div>
    </div>
</section>

{% endblock %}
